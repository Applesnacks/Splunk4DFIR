#!/bin/bash

#SPLUNK_URL = Domain or IP hosting the Splunk. Please input without the HTTP or HTTPS - for instance `localhost` or `mydomain.com`
#SPLUNK_PORT = Splunk HTTP port - 8000 by default (unused at the moment in the script)
#SPLUNK_MPORT = Splunk Management port - 8089 by default
#SPLUNK_SSL = If set to True, the SSL certificate will be checked. Set to False for autogenerated certs. 
#SPLUNK_USER = Splunk user with the rights to make configuration changes (add HEC token, indexes,etc)
#SPLUNK_PASS = User password

echo "SPLUNK_URL = 127.0.0.1" > "/opt/splunk/etc/apps/Splunk4DFIR/bin/evtx2splunk/.env"
echo "SPLUNK_PORT = 8000" >> "/opt/splunk/etc/apps/Splunk4DFIR/bin/evtx2splunk/.env"
echo "SPLUNK_MPORT = 8089" >> "/opt/splunk/etc/apps/Splunk4DFIR/bin/evtx2splunk/.env"
echo "SPLUNK_SSL = False" >> "/opt/splunk/etc/apps/Splunk4DFIR/bin/evtx2splunk/.env"
echo "SPLUNK_USER = admin" >> "/opt/splunk/etc/apps/Splunk4DFIR/bin/evtx2splunk/.env"
echo "SPLUNK_PASS = changeme" >> "/opt/splunk/etc/apps/Splunk4DFIR/bin/evtx2splunk/.env"
cd /opt/splunk/etc/apps/Splunk4DFIR/bin/evtx2splunk/
python evtx2splunk.py --input /mnt/artifacts/evtx/ --index evtx
